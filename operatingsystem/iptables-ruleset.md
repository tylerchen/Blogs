Iptables规则集合
=====

### 内网端口代理/转发内网端口

两台虚拟机模拟环境：

    转发服务器：192.168.30.131  端口：2222
    SFTP服务器：192.168.30.134  端口：22

转发服务器的路由如下：

    echo 1 >/proc/sys/net/ipv4/ip_forward
    iptables -t nat -A PREROUTING -p tcp -m tcp --dport 2222 -d 192.168.30.131 -j DNAT --to 192.168.30.134:22
    iptables -t nat -A POSTROUTING -p tcp -m tcp --dport 22 -j MASQUERADE

### 基础IPTables设置，允许SSH端口，转发80端口，允许出去的访问

    # Generated by iptables-save v1.3.5 on Tue Mar  5 20:47:17 2013
    *filter
    :INPUT ACCEPT [322699:40543546]
    :FORWARD ACCEPT [0:0]
    :OUTPUT ACCEPT [511732:52441691]
    -P INPUT DROP
    -P OUTPUT ACCEPT
    -P FORWARD ACCEPT
    -A INPUT -p icmp -j ACCEPT
    -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
    -A INPUT -p tcp --dport 22 -j ACCEPT
    -A INPUT -p tcp --dport 21 -j ACCEPT
    -A INPUT -p tcp --dport 23 -j ACCEPT
    -A INPUT -p tcp --dport 80 -j ACCEPT
    -A INPUT -p tcp --dport 111 -j ACCEPT
    -A INPUT -p udp --dport 111 -j ACCEPT
    -A INPUT -p tcp --dport 631 -j ACCEPT
    -A INPUT -p udp --dport 631 -j ACCEPT
    COMMIT
    # Completed on Tue Oct 23 10:31:23 2012
    # Generated by iptables-save v1.3.5 on Tue Oct 23 10:31:23 2012
    *nat
    :PREROUTING ACCEPT [1735461:122971484]
    :POSTROUTING ACCEPT [225770:15285494]
    :OUTPUT ACCEPT [225770:15285494]
    -A PREROUTING -d 192.168.1.6 -p tcp -m tcp --dport 80 -j DNAT --to-destination 192.168.1.6:8081 
    COMMIT
    # Completed on Tue Oct 23 10:31:23 2012
    
    
